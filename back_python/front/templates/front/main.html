{% extends "front/base.html" %}
{% load static %}
{% block navbar-header %}
{% endblock %}
<!-- 内容区 -->
{% block content %}
<div class="container mainPage"    ms-controller="main">
  <nav class="navbar navbar-default  navbar-fixed-top" style="z-index:10000" ms-if="isLoading">
    <div  class="col-xs-12 text-center">
        <i style="color:#03BC00;margin-top:10px"  class="fa fa-spinner fa-pulse fa-2x"></i>
    </div>
  </nav>
  <div class="content" ms-html="@htmlcontent">
  </div>
  <nav ms-visible="isRoot"  class="navbar navbar-default  navbar-fixed-bottom">
      <div class="container">
      <div class="row" style="padding-bottom:0px">
          <div  class="col-xs-3 col-md-3 text-center" style="padding:0px;">
            <a id="mainNavHabit" class="forNav navButton active sound" href="#!/main/activity"   data-root="habit" ms-click="focus">
              <span class="glyphicon glyphicon-tint"></span>
              <div>活动</div>
            </a>
          </div>
          <div class="col-xs-3 col-md-3 text-center" style="padding:0px">
            <a class="forNav navButton sound" href="#!/main/grain" data-root="grain" ms-click="focus">
              <span class="glyphicon glyphicon-tree-deciduous"></span>
              <div>成长</div>
            </a>
          </div>
          <div class="col-xs-3 col-md-3 text-center"　style="padding:0px">
            <a class="forNav navButton sound" href="#!/main/sns" data-root="sns" ms-click="focus">
              <span class="glyphicon glyphicon-eye-open"></span>
              <div>舞台</div>
            </a>
          </div>
          <div class="col-xs-3 col-md-3 text-center" style="padding:0px">
            <a class="forNav navButton sound" data-root="my" href="#!/main/my" ms-click="focus">
              <span class="glyphicon glyphicon-asterisk"></span>
              <div>我</div>
            </a>
          </div>
      </div>
      </div>
   </nav>
</div>
<div class="modal fade" id="sysMsg"  tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-body">
        <!-- <div class="modal-header">
          <h4 class="modal-title" id="myModalLabel"><i class="fa fa-warning" style="color:orange"></i>系统通知</h4>
        </div> -->
        <div class="text-center" style="width:100%;height:60px;margin-top:15px">
          <p id="contentMsg"></p>
          <div style="margin-top:10px">
            <a href="#" class="button button-pill button-tiny  button-action" id="knowAleady">我知道了</a>
          </div>
       </div>
    </div>
  </div>
</div>
</div>
{% endblock %}
<!-- 主要应用代码区 -->
{% block extrajs %}
<script src="{% static "front/js/avalon/mmRouter.js" %}"></script>
  <script>
    　　 (function($,$av){
            $(function(){
              console.log(typeof(avalon))
              var vm=$av.define({
                $id:"main",
                isLoading:true,
                isRoot:true,
                htmlcontent:"hello",
                activitys:[
                {name:"21天习惯养成包",memo:"行为养成习惯"},
                {name:"36天习惯养成包",memo:"习惯形成性格"},
                {name:"90天习惯养成包",memo:"性格决定命运"}],
                focus:function(el){
                  $(".active").removeClass("active")
                  $("span",el.currentTarget).addClass("active")
                  $("div",el.currentTarget).addClass("active")
                }
              });
              function callback(p){
                vm.currPath = this.path;
                console.log(vm.currPath);
                fetch(vm.currPath)
                  .then(function(response) {
                    return response.text()
                  }).then(function(body) {
                    vm.htmlcontent = body
                  })
              }
              $av.router.add("/main/activity", callback);
              $av.router.add("/main/grain", callback);
              $av.router.add("/main/sns", callback);
              $av.router.add("/main/my", callback);
              $av.history.start({
                  root: "/root"
              })
              #当前页面初次加载时
              var hash = location.hash.replace(/#!?/, '')
              $av.router.navigate(hash || '/main/habit', 2)//默认打开
              $("span","#mainNavHabit").addClass("active")
              $("div","#mainNavHabit").addClass("active")
　
              avalon.scan(document.body)

            })
         })(jQuery,avalon)
  </script>
{% endblock%}
